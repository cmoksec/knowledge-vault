# $ 4ctive_fuzz

Created: December 17, 2024 11:34 PM
Tags: refreshers

# Фаззинг: основные концепции

Термин «фаззинг» появился в работе Барта Миллера «The Fuzz Generator» (1988). Это метод тестирования программ путём отправки некорректных данных для выявления уязвимостей.

## Подходы к тестированию

- Черный ящик: тестирование без доступа к коду, через внешние интерфейсы
    - Применяется для веб-сервисов
    - Может использоваться для свипинга (поиск схожих уязвимостей)
- Серый ящик: комбинация черного ящика и реверс-инжиниринга
- Белый ящик: тестирование с доступом к исходному коду

## Классификация фаззеров

- По методу управления:
    - Генерация: создание случайных данных
    - Мутация: изменение валидных данных
- По "интеллекту":
    - Dump: без знания структуры данных
    - Smart: с пониманием структуры данных

Активный фаззинг применяется для автоматического тестирования веб-приложений, включая проверку параметров запросов, дирбастинг и поиск распространённых уязвимостей (XXE, CMD injection, SQL injection).

---

## DIRB

DIRB - это сканер веб-контента для поиска существующих (в том числе скрытых) веб-объектов. Основные характеристики:

- Работает на основе словарей - имеет встроенные словари, но позволяет использовать и пользовательские
- Основное назначение - помощь в профессиональном аудите веб-приложений и тестировании безопасности
- Ищет специфические веб-объекты, которые могут быть пропущены обычными CGI-сканерами
- Является сканером содержимого, а не сканером уязвимостей

### Использование:

```bash
dirb <базовый_адрес> [<список(и)_словарей>] [опции]
```

### Примечание

- базовый_адрес: Базовый URL для сканирования (Используйте -resume для возобновления сессии)
- список(и)_словарей: Списки слов (список_слов1,список_слов2,список_слов…)

### Горячие клавиши

- 'n' → Перейти к следующей директории
- 'q' → Остановить сканирование (Сохранить состояние для возобновления)
- 'r' → Сохранить статистику сканирования

### Опции

- **-a** <строка_агента> : Задайте ваш пользовательский USER_AGENT
- **-c** <строка_кукиз> : Установите куки для HTTP запроса
- **-f** : Забавный тюнинг при выявлении NOT_FOUND (404)
- **-H** <строка_заголовка> : Задайте пользовательский заголовок HTTP запроса
- **-i** : Использовать поиск без учёта регистра
- **-l** : Печатать заголовок "Location" когда найден-N: Игнорировать ответы с этим HTTP кодом
- **-o** <файл_для_вывода> : Сохранить вывод на диск
- **-p** <прокси[:порт]> : Использовать прокси (Порт по умолчанию 1080)-P: Аутентификация на прокси
- **-r** : Не искать рекурсивно
- **-R** : Интерактивная рекурсия (Спрашивать для каждой директории)
- **-S** : Молчаливый режим. Не показывать тестируемые слова (Для простых терминалов)
- **-t** : Не принуждать к конечному слешу '/' в URL
- **-u** <пользователь:пароль> : HTTP аутентификация
- **-v** : Показывать также страницы NOT_FOUND
- **-w** : Не показывать сообщений WARNING
- **-X** <расширение> / -x <расширения_файла> : Применить эти расширения к каждому слову
- **-z** <миллисекунды&gt; : Добавить миллисекунды,для задержки, чтобы
не стать причиной экстенсивного флуда.

## Gobuster

Gobuster - это альтернативная программа для фаззинга директорий, которая имеет следующие преимущества по сравнению с Dirb:

- Многопоточность
- Простой unix-подобный интерфейс
- Возможность точной настройки
- Написана на Go, что обеспечивает более высокую производительность
- Поддержка одновременного брутфорса папок и нескольких расширений
- Кроссплатформенность
- Не требует среду выполнения

### Общие опции командной строки

- **-fw:** Принудительная обработка доменов при обнаружении поддержки групповых символов.
- **-q:** Отключить вывод банеров/линий.
- **-t <потоки>:** Количество одновременных потоков (по умолчанию: 10).
- **-u <url/домен>:** Полный URL (включая схему) или базовое имя домена.
- **-v:** Вербальный вывод (показывать все результаты).
- **-w <словарь>:** Путь до используемого для брут-форса словаря.

### Опции командной строки для режима DNS

- **-cn:** Показывать CNAME записи (не может использоваться с опцией '-i').
- **-i:** Показывать в результате все IP адреса.

### Опции командной строки для режима DIR

- **-a <строка пользовательского агента>:** Указать строку пользовательского агента для отправки в заголовках запросов.
- **-c <http cookies>:** Отправлять с каждым запросом эти куки (симулирование аутентификации).
- **-e:** Расширенный режим, печатает полные URL.
- **-f:** Добавлять / (слэш) для брут-форса директорий.
- **-k:** Пропустить верификацию SSL сертификатов.
- **-l:** Показать длину ответа.
- **-n:** Режим "без статуса", отключить вывод в результатах кода статуса.
- **-o <файл>:** Имя файла для записи вывода.
- **-p <proxy url>:** Прокси для использования со всеми запросами (схема должна соответствовать URL схеме).
- **-r:** Следовать редиректам.
- **-s <коды статуса>:** Разделенный запятой набор из списка кодов статуса, которые считаются "положительными" (по умолчанию: 200, 204, 301, 302, 307).
- **-x <расширения>:** Список расширений для проверки, можно не указывать.
- **-P <пароль>:** Пароль HTTP авторизации (только Basic Auth, если пропущено, появится запрос).
- **-U <имя пользователя>:** Имя пользователя HTTP авторизации (только Basic Auth).

```bash
gobuster dir -u http://testphp.vulnweb.com -w
/usr/share/dirbuster/wordlists/directory-list-2.3-
medium.txt –t 20 –s “200,204,301,302,404” -x php,html
```

---

## Wfuzz

**Wfuzz** — это огромный фреймворк для фаззинга веб-приложений, который включает в себя:

- **API на питоне** (сам wfuzz тоже написан на питоне).
- **Прикладные утилиты** (например, wfpayload для генерации полезных нагрузок).
- **Фаззер**, к которому можно подключать плагины.

Подробное руководство по программе можно посмотреть по адресу:

[https://russianblogs.com/article/6886816499/](https://russianblogs.com/article/6886816499/)

С помощью этой утилиты можно фаззить буквально всё веб-приложение:

- Параметры GET, POST и прочих запросов.
- Тело запроса.
- Куки.
- Директории сайта и т.д.

### Опции командной строки для фильтрации ответов

- **-hc** — Не показывать ответы с указанным кодом ответа.
- **-hl** — Не показывать ответы с указанным количеством строк.
- **-hw** — Не показывать ответы с указанным количеством слов.
- **-hh** — Не показывать ответы с указанным количеством символов.
- **-sc** — Показывать ответы только с указанным кодом ответа.
- **-sl** — Показывать ответы только с указанным количеством строк.
- **-sw** — Показывать ответы только с указанным количеством слов.
- **-sh** — Показывать ответы только с указанным количеством символов.

### Использование полезной нагрузки в Wfuzz

Полезная нагрузка указывается с помощью:

- **-z file,путь*до*файла** (или -**w путь*до*файла**, если используются словари).

Кроме нагрузки типа `file`, можно использовать и другие. Например, с помощью `range` можно сделать список из чисел, что удобно при поиске рабочих параметров в URL:

```bash
wfuzz -c -z range,0-10 --hc 404
```

Полный список полезных нагрузок можно посмотреть с помощью команды:

```bash
wfuzz -e payloads
```

### Фаззинг директорий, файлов и параметров в URL

```bash
wfuzz -z file,wordlists/directory-list-2.3-
medium.txt --hc 404 http://testphp.vulnweb.com/FUZZ
```

### Фаззинг POST-запросов

```bash
wfuzz -z file,common_pass.txt -d "uname=FUZZ&pass=FUZZ" --hc 302 http://example.com/login.php
```

### Фаззинг Куков

```bash
wfuzz -z file,common.txt -b cookie1=FUZZ -b cookie2=value2 http://example.com/index.php
```

Wfuzz будет генерировать такие HTTP запросы, где вместо **FUZZ** будут подставляться значения из словаря.

```makefile
GET /index.php HTTP/1.1
Host: example.com
Accept: */*
Content-Type: application/x-www-form-urlencoded
Cookie: cookie1=FUZZ; cookie2=value2
User-Agent: Wfuzz/2.2.11
Connection: close
```

### Фаззинг Хедеров

Можно добавлять свои хедеры в запрос, или также изменять уже существующие. В параметр **-H** указываются данные в формате «хедер: значение»:

```bash
wfuzz -z file,headers.txt -H "myheader: FUZZ" -H "User-Agent: Googlebot-News" http://example.com/
```

Запрос к серверу будет таким:

```makefile
GET / HTTP/1.1
Host: example.com
Accept: */*
Content-Type: application/x-www-form-urlencoded
myheader: FUZZ
User-Agent: Googlebot-News
Connection: close
```

### Кодировка

В некоторых случаях веб-приложение принимает закодированные данные (например, base64 или sha1). Wfuzz позволяет кодировать значения из словаря перед отправкой на сервер. Для этого в параметре **-z** после указания типа итератора (файл, последовательность, стандартный ввод stdin и т. д.) и самого итератора, через запятую указывается тип кодировки:

```bash
wfuzz -u example.net/main.php?page=FUZZ -z file,wordlists/common.txt,base64 --sw 40
```

Полный список возможных способов кодирования с описанием можно посмотреть, введя команду:

```bash
wfuzz -e encoders
```

Кодировки можно применять по цепочке, разделяя их знаком «-». Тогда Wfuzz будет по очереди кодировать и отсылать на сервер полезную нагрузку с разными кодировками.

```bash
wfuzz -u "http://example/main.php?page=FUZZ" -z list,just_one_payload,none-base64-md5
```

---

## FFuF

Ffuf — инструмент, аналогичный wfuzz, с более продуманной оптимизацией работы с памятью и активной поддержкой разработчиков. В некоторых ситуациях его использование может быть более предпочтительным. Полное руководство доступно по адресу: [Руководство по Ffuf](https://zen.yandex.ru/media/cisoclub/rukovodstvo-po-fuzz-faster-u-fool-ffuf-612504efb37e226a924a89f9).

**ВАЖНО!!!!!**

Ffuf по умолчанию не добавляет заголовки в запросы. Если требуется, например, заголовок `Content-Type`, его необходимо указать явно. ВСЕГДА УКАЗЫВАЙ Content-Type ДЛЯ ПОСТ ЗАПРОСОВ!

```bash
-H "Content-Type: <нужное вписать>"
```

### Фаззинг директорий и файлов

```bash
ffuf -u "http://testphp.vulnweb.com/FUZZ" -fs 16,153,276,4958 -c -t 40 -e .php,.html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -mc all
```

**Параметры команды:**

- `u` – URL, к которому будет выполняться запрос.
- `w` – словари для фаззинга.
- `fs` – исключает ответы с размером **16,153,276,4958** (выбирает размер ответов от неудачных попыток, чтобы отфильтровать ненужные результаты).
- `c` – выделение цветом в выводе.
- `t` – количество потоков (по умолчанию 10).
- `e` – указывает расширения файлов, которые ищем (.php, .html).
- `mc` – игнорирует все коды ответа сервера.

### Брут формы авторизации

```bash
ffuf -u "http://testphp.vulnweb.com/userinfo.php" -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "uname=HFUZZ&pass=WFUZZ" -w /usr/share/wfuzz/wordlist/general/test.txt:HFUZZ -w /usr/share/wfuzz/wordlist/general/test.txt:WFUZZ -c -fs 14 -t 40 -mc all
```

**Параметры команды:**

- `u` – URL для отправки запроса.
- `X` – метод HTTP (в данном случае POST).
- `H` – заголовок запроса (здесь указывается `Content-Type`).
- `d` – данные для отправки (логин и пароль).
- `w` – словарь для брута (два словаря для логина и пароля).
- `c` – выделение цветом в выводе.
- `fs` – исключает ответы с размером 14.
- `t` – количество потоков (по умолчанию 10).
- `mc` – игнорирует все коды ответа сервера.

### Фаззинг GET-параметров

```bash
ffuf -u "http://web-site/?FUZZ" -fs 626 -c -t 40 -w /SecLists-master/Discovery/Web-Content/burp-parameter-names.txt -mc all
```

**Параметры команды:**

- `u` – URL, к которому будет выполняться запрос.
- `fs` – исключает ответы с размером 626.
- `c` – выделение цветом в выводе.
- `t` – количество потоков (по умолчанию 10).
- `w` – словарь для поиска имен GET-параметров.
- `mc` – игнорирует все коды ответа сервера.

---

### Dirsearch

Dirsearch – это простой инструмент командной строки, предназначенный 
для брут-форса (поиска путём полного перебора) директорий и файлов на 
веб-сайтах.

```bash
dirsearch -u http://testphp.vulnweb.com/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php,html -f
```

**Параметры команды:**

- `u` – URL целевого веб-сайта.
- `w` – путь к словарю для брут-форса директорий.
- `e` – расширения файлов для поиска (в данном случае `php` и `html`).
- `f` – флаг для завершения работы при нахождении первого совпадения.

---

### Заценить Feroxbuster

---

### Другие Полезные Ресурсы

- [**SecLists**](https://github.com/danielmiessler/SecLists.git) – база с хорошими фаззинг-листами, содержащая словари с популярными
логинами, паролями, директориями сайтов и фаззинг-листы для различных
уязвимостей (SQLi, XSS, LFI и т.д.).
- [**Payloads All The Things**](https://github.com/swisskyrepo/PayloadsAllTheThings) – популярный репозиторий с полезными нагрузками
- [**FuzzDB**](https://github.com/fuzzdb-project/fuzzdb.git) – это проект, объединяющий в себе большое количество
фаззинг-баз, упорядоченных по своему назначению.

---

## Классические фаззинг-словари

![image.png]($%204ctive_fuzz%2015f021737a8980779ed0c5081ac43915/image.png)

[Заголовки HTTP.pdf]($%204ctive_fuzz%2015f021737a8980779ed0c5081ac43915/%25D0%2597%25D0%25B0%25D0%25B3%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B8_HTTP.pdf)

[5.1 Активный фаззинг и сбор информации.pdf]($%204ctive_fuzz%2015f021737a8980779ed0c5081ac43915/5.1_%25D0%2590%25D0%25BA%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2584%25D0%25B0%25D0%25B7%25D0%25B7%25D0%25B8%25D0%25BD%25D0%25B3_%25D0%25B8_%25D1%2581%25D0%25B1%25D0%25BE%25D1%2580_%25D0%25B8%25D0%25BD%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8.pdf)