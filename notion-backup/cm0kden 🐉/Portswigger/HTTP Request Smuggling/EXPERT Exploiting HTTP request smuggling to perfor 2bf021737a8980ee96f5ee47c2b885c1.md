# EXPERT: Exploiting HTTP request smuggling to perform web cache deception

https://siunam321.github.io/ctf/portswigger-labs/HTTP-Request-Smuggling/smuggling-17/

![Снимок экрана 2025-12-04 в 11.23.31.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.23.31.png)

![Снимок экрана 2025-12-04 в 11.22.45.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.22.45.png)

Confirm:

![Снимок экрана 2025-12-04 в 11.25.28.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.25.28.png)

Notice enabled caching for `tracking.js`

![Снимок экрана 2025-12-04 в 11.27.49.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.27.49.png)

![Снимок экрана 2025-12-04 в 11.34.42.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.34.42.png)

![Снимок экрана 2025-12-04 в 11.44.09.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.44.09.png)

Reload the page in incognito and check `tracker.js`

![Снимок экрана 2025-12-04 в 11.44.21.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.44.21.png)

Submit solution:

![Снимок экрана 2025-12-04 в 11.50.56.png](EXPERT%20Exploiting%20HTTP%20request%20smuggling%20to%20perfor%202bf0-85c1/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_11.50.56.png)

```python
TIME | FRONT-END                    | BACK-END
-----|------------------------------|--------------------------------
T1   | Attacker: POST with smuggling| Sees: POST (CL:39)
     |                              | Reads 39 bytes, leaves in buffer
-----|------------------------------|--------------------------------
T2   | Victim: GET tracking.js      | Buffer has: GET /my-account...
     | Forwards to back-end         | Receives: tracking.js appended
-----|------------------------------|--------------------------------
T3   | Waiting...                   | SEES: GET /my-account...
     |                              |       X-Foo: xGET /tracking.js...
     |                              | INTERPRETS: Bad header X-Foo
     |                              | PROCESSES: /my-account endpoint
-----|------------------------------|--------------------------------
T4   | Receives: Admin page response| RETURNS: Admin's /my-account
     | THINKS: This is for tracking.js|
     | CACHES: Admin page as tracking.js
-----|------------------------------|--------------------------------
T5   | Attacker requests tracking.js| Not reached (cached)
     | GETS: Cached admin page      |
```