# Using application functionality to exploit insecure deserialization

**Vulnerability Summary:**

Insecure PHP deserialization allows arbitrary file deletion by manipulating the `avatar_link` attribute in the session object.

**Attack Flow:**

1. **Identify Attack Vector:**
    - Account deletion feature at `POST /my-account/delete`
    - Session cookie contains serialized object with `avatar_link` attribute
2. **Modify Serialized Object:**
    - Change `avatar_link` to target file: `/home/carlos/morale.txt`
    - Update length indicator to match: `s:23:"/home/carlos/morale.txt"`
3. **Execute Attack:**
    - Send modified session cookie in `POST /my-account/delete` request
    - Application deletes the file specified in `avatar_link`

**Impact:**

Arbitrary file deletion through insecure deserialization during account deletion process.

![image.png](Using%20application%20functionality%20to%20exploit%20insecur/image.png)

![image.png](Using%20application%20functionality%20to%20exploit%20insecur/image%201.png)

![image.png](Using%20application%20functionality%20to%20exploit%20insecur/image%202.png)