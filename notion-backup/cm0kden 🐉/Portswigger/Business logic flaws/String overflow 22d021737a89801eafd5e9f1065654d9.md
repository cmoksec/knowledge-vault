# String overflow

Example: An application has a registration function, and all users that have @dontwannacry email domain are considered administrators. Meaning, if we could get a user with such email, we can grant ourselves an admin privelege.

![image.png](String%20overflow/image.png)

First, register an account with a very long string, using a client email provided by the lab:

```yaml
attackeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee@exploit-0a8600fb04bf93e88000e85801d600e5.exploit-server.net
```

After logging in, we see that the string gets truncated by exactly 255 symbols:

![image.png](String%20overflow/image%201.png)

With that, letâ€™s capture an email whose 255th character would be `m` from `@[dontwannacry.com](http://dontwannacry.com)` suffix, where `dontwannacry.com` would just be a subdomain for a mailserver `exploit-0a8600fb04bf93e88000e85801d600e5.exploit-server.net`: 

```yaml
attackeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee@dontwannacry.com.exploit-0a8600fb04bf93e88000e85801d600e5.exploit-server.net
```

This string, if truncated to 255 symbols, is exactly `<longstring>@dontwannacry.com` . And the confirmation email is still sent to user-controllable mailserver.

![image.png](String%20overflow/image%202.png)

We can login afterwards and access the admin functionality:

![image.png](String%20overflow/image%203.png)