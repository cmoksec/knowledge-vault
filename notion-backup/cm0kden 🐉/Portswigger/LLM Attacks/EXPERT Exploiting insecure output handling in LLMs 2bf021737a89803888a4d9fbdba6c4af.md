# EXPERT: Exploiting insecure output handling in LLMs

Chat is vulnerable to XSS:

![image.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/image.png)

![Снимок экрана 2025-12-04 в 10.27.03.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.27.03.png)

Review feature is not vulnerable to XSS:

![Снимок экрана 2025-12-04 в 10.29.48.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.29.48.png)

We can ask AI chat about a product that we’ve poisoned with XSS payload:

![Снимок экрана 2025-12-04 в 10.31.09.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.31.09.png)

It’s filtering the content. Okay, let’s make a legit-looking comment:

![Снимок экрана 2025-12-04 в 10.34.56.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.34.56.png)

Seems like we need to escape double quotes:

![Снимок экрана 2025-12-04 в 10.35.33.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.35.33.png)

![Снимок экрана 2025-12-04 в 10.35.11.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.35.11.png)

Alright another try:

![Снимок экрана 2025-12-04 в 10.37.47.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.37.47.png)

Boom:

![Снимок экрана 2025-12-04 в 10.38.30.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.38.30.png)

Knowing carlos is asking LLM for a specific product, poison it as well and attack him:

![Снимок экрана 2025-12-04 в 10.39.14.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.39.14.png)

Account is deleted via this button

![Снимок экрана 2025-12-04 в 10.39.41.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.39.41.png)

Poison the product:

![Снимок экрана 2025-12-04 в 10.40.35.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.40.35.png)

Carlos asked LLM about it after some time:

![Снимок экрана 2025-12-04 в 10.44.08.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.44.08.png)

![Снимок экрана 2025-12-04 в 10.44.35.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.44.35.png)

![Снимок экрана 2025-12-04 в 10.44.47.png](EXPERT%20Exploiting%20insecure%20output%20handling%20in%20LLMs/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2025-12-04_%D0%B2_10.44.47.png)