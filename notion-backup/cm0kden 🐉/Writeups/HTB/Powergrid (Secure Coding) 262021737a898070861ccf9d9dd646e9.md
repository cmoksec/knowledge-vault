# Powergrid (Secure Coding)

# Writeup: –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (injection —á–µ—Ä–µ–∑ `users.txt`)

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ñ–∞–π–ª `users.txt` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ—Å—Ç–µ–π—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞ –∏–º–µ–ª–∞ —Ñ–æ—Ä–º–∞—Ç: username|password_hash|role

–ü—Ä–∏–º–µ—Ä: 1000|03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4|operator

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ —Å–∏–º–≤–æ–ª-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å `|`.

## ‚ö†Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç—å

–¢–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π **–Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–ª–∏—Å—å** –∏ **–Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏—Å—å**, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–≥ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–∏–º–≤–æ–ª—ã `|` –∏ –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ `\\n`.

–ü—Ä–∏–º–µ—Ä payload‚Äô–∞ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: attacker|<hash_—Å–≤–æ–µ–≥–æ_–ø–∞—Ä–æ–ª—è>|admin

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ñ–∞–π–ª –ø–æ–ª—É—á–∞–ª–∞—Å—å –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å —Ä–æ–ª—å—é `admin`.

![image.png](Powergrid%20(Secure%20Coding)/image.png)

![image.png](Powergrid%20(Secure%20Coding)/image%201.png)

![image.png](Powergrid%20(Secure%20Coding)/image%202.png)

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∞—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–ª –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º –≤—Ö–æ–¥–µ –ø–æ–¥ —Å–≤–æ–∏–º –∏–º–µ–Ω–µ–º.

–≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ **injection —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–º–æ–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º `|`, –±—ã–ª –≤—ã–±—Ä–∞–Ω **JSON**:

![image.png](Powergrid%20(Secure%20Coding)/image%203.png)

![image.png](Powergrid%20(Secure%20Coding)/image%204.png)

![image.png](Powergrid%20(Secure%20Coding)/image%205.png)